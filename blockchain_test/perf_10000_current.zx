// Performance Test - 10,000 Transactions
// Matches TokenSilent contract pattern used in smaller benchmarks

contract TokenSilent {
    data total_supply = 0
    data balances = {}
    
    action mint(to, amount) {
        let to_balance = balances[to]
        if to_balance == null {
            to_balance = 0
        }
        balances[to] = to_balance + amount
        total_supply = total_supply + amount
        return { "success": true }
    }
    
    action transfer(from, to, amount) {
        let from_balance = balances[from]
        if from_balance == null {
            from_balance = 0
        }
        
        if from_balance < amount {
            return { "success": false }
        }
        
        balances[from] = from_balance - amount
        
        let to_balance = balances[to]
        if to_balance == null {
            to_balance = 0
        }
        balances[to] = to_balance + amount
        
        return { "success": true }
    }
}

print("\n" + "=" * 80)
print("  PERFORMANCE TEST - 10,000 Transactions")
print("=" * 80 + "\n")

let token = TokenSilent()
token.mint("0xTEST", 100000000)
print("âœ… Token initialized\n")

print("Starting 10,000 transfer test...")
let start = time()

let i = 0
let success = 0
let target = 10000

while i < target {
    let addr = "0xUSER_" + string(i)
    let res = token.transfer("0xTEST", addr, 10)
    
    if res["success"] {
        success = success + 1
    }
    
    i = i + 1
}

let end = time()
let elapsed = end - start
let tps = (success * 1000) / elapsed

print("\n" + "=" * 80)
print("  RESULTS")
print("=" * 80)
print("  Transactions: " + string(success) + " / " + string(target))
print("  Time: " + string(elapsed) + " ms (" + string(elapsed / 1000) + " seconds)")
print("  TPS: " + string(tps))
print("=" * 80)
